var map,featureList,app={};var flSearch=[],alSearch=[],msSearch=[],laSearch=[],txSearch=[];app.author="Shin Kobara, GCOOS";app.copyright="GCOOS";app.title="Clean Marinas";app.html="https://geo.gcoos.org/marina/";app.desc="Clean Marinas Program in the Gulf of Mexico";map=L.map("map",{zoomControl:false,scrollWheelZoom:false,zoom:6,center:[28,-89.5],attributionControl:false});var mapquestOSM=L.tileLayer("http://{s}.mqcdn.com/tiles/1.0.0/osm/{z}/{x}/{y}.png",{maxZoom:20,subdomains:["otile1","otile2","otile3","otile4"],attribution:'Tiles courtesy of <a href="http://www.mapquest.com/" target="_blank">MapQuest</a> <img src="http://developer.mapquest.com/content/osm/mq_logo.png">. Map data (c) <a href="http://www.openstreetmap.org/" target="_blank">OpenStreetMap</a> contributors, CC-BY-SA.'});var mapquestHYB=L.layerGroup([L.tileLayer("http://{s}.mqcdn.com/tiles/1.0.0/sat/{z}/{x}/{y}.jpg",{maxZoom:20,subdomains:["oatile1","oatile2","oatile3","oatile4"]}),L.tileLayer("http://{s}.mqcdn.com/tiles/1.0.0/hyb/{z}/{x}/{y}.png",{maxZoom:20,subdomains:["oatile1","oatile2","oatile3","oatile4"],attribution:'Labels courtesy of <a href="http://www.mapquest.com/" target="_blank">MapQuest</a> <img src="http://developer.mapquest.com/content/osm/mq_logo.png">. Map data (c) <a href="http://www.openstreetmap.org/" target="_blank">OpenStreetMap</a> contributors, CC-BY-SA. Portions Courtesy NASA/JPL-Caltech and U.S. Depart. of Agriculture, Farm Service Agency | Points data from <a href="http://galvbay.org">galvbay.org</a>'})]);var esriOcean=L.layerGroup([L.esri.tiledMapLayer("http://services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer",{attribution:'&copy; <a href="http://www.esri.com/">Esri</a>, GEBCO, NOAA, National Geographic, DeLorme, HERE, Geonames.org, and other contributors| Points data from <a href="http://galvbay.org">galvbay.org</a>'}),L.esri.tiledMapLayer("http://server.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer",{attribution:'&copy; <a href="http://www.esri.com/">Esri</a>, GEBCO, NOAA, National Geographic, DeLorme, HERE, Geonames.org, and other contributors| Points data from <a href="http://galvbay.org">galvbay.org</a>'})]);var esriTopo=L.esri.tiledMapLayer("http://services.arcgisonline.com/arcgis/rest/services/World_Topo_Map/MapServer",{attribution:'&copy; <a href="http://www.esri.com/">Esri</a>, HERE, DeLorme, TomTom, Intermap, increment P Corp., GEBCO, USGS, FAO, NPS, NRCAN, GeoBase, IGN, Kadaster NL, Ordnance Survey, Esri Japan, METI, Esri China (Hong Kong), swisstopo, MapmyIndia, Â© OpenStreetMap contributors, GIS User Comm. | Points data from <a href="http://galvbay.org">galvbay.org</a>'});var esriImage=L.tileLayer("http://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{attribution:'&copy; <a href="http://www.esri.com/">Esri</a>, DigitalGlobe, Earthstar Geographics, CNES/Airbus DS, GeoEye, USDA FSA, USGS, Getmapping, Aerogrid, IGN, IGP, swisstopo, and the GIS User Community | Points data from <a href="http://galvbay.org">galvbay.org</a>',maxZoom:18,});var cartodb_light=L.tileLayer("http://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",{attribution:'Map data &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, &copy; <a href="http://cartodb.com/attributions">CartoDB</a> | Points data from <a href="http://galvbay.org">galvbay.org</a>',maxZoom:18});var cartodb_dark=L.tileLayer("http://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png",{attribution:'Map data &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, &copy; <a href="http://cartodb.com/attributions">CartoDB</a> | Points data from <a href="http://galvbay.org">galvbay.org</a>',maxZoom:18});var baseLayers={"Street Map":mapquestOSM,Light:cartodb_light,Dark:cartodb_dark,"Imagery with Streets":mapquestHYB,"Esri World Imagery":esriImage,Topography:esriTopo};map.addLayer(cartodb_light);var zoomControl=L.control.zoom({position:"bottomright"}).addTo(map);L.control.defaultExtent({position:"bottomright"}).addTo(map);var locateControl=L.control.locate({position:"bottomright",drawCircle:true,follow:true,setView:true,keepCurrentZoomLevel:true,markerStyle:{weight:1,opacity:0.8,fillOpacity:0.8},circleStyle:{weight:1,clickable:false},icon:"fa fa-map-marker",metric:false,strings:{title:"My location",metersUnit:"meters",feetUnit:"feet",popup:"You are within {distance} {unit} from this point",outsideMapBoundsMsg:"You seem located outside the boundaries of the map"},locateOptions:{maxZoom:17,watch:true,enableHighAccuracy:true,maximumAge:10000,timeout:10000}}).addTo(map);map.on("dragstart",locateControl._stopFollowing,locateControl);var drawnItems=L.featureGroup().addTo(map);map.addControl(new L.Control.Draw({edit:{featureGroup:drawnItems}}));map.on("draw:created",function(b){var a=b.layer;drawnItems.addLayer(a)});L.Control.measureControl().addTo(map);L.Control.FileLayerLoad.LABEL='<i class="fa fa-folder-open"></i>';L.Control.fileLayerLoad({fitBounds:true,layerOptions:{style:{color:"red",opacity:1,fillOpacity:1,weight:2,clickable:false}},fileSizeLimit:1024,formats:[".geojson",".kml"]}).addTo(map);$(".leaflet-top.leaflet-left").hide();var geoSearchControl=new L.esri.Geocoding.Controls.Geosearch({position:"bottomright",providers:[new L.esri.Geocoding.Controls.Geosearch.Providers.FeatureLayer({url:"//services.arcgis.com/uCXeTVveQzP4IIcx/arcgis/rest/services/gisday/FeatureServer/0/",searchFields:["Name","Organization"],label:"GIS Day Events",bufferRadius:5000,formatSuggestion:function(a){return a.properties.Name+" - "+a.properties.Organization}})]}).addTo(map);var results=new L.LayerGroup().addTo(map);geoSearchControl.on("results",function(b){results.clearLayers();for(var a=b.results.length-1;a>=0;a--){results.addLayer(L.marker(b.results[a].latlng))}console.log("geocoding!")});function updateAttribution(a){$.each(map._layers,function(b,c){if(c.getAttribution){$("#attribution").html((c.getAttribution()))}})}map.on("layeradd",updateAttribution);map.on("layerremove",updateAttribution);var attributionControl=L.control({position:"bottomleft"});attributionControl.onAdd=function(a){var b=L.DomUtil.create("div","leaflet-control-attribution");b.innerHTML="<span class='hidden-xs'><a href='https://products.gcoos.org/' target='_blank'>GCOOS</a> | </span><a href='#' onclick='$(\"#attributionModal\").modal(\"show\"); return false;'>Attribution</a>";return b};map.addControl(attributionControl);var highlight=L.geoJson(null);var highlightStyle={stroke:false,fillColor:"#00FFFF",fillOpacity:0.7,radius:10};function clearHighlight(){highlight.clearLayers()}map.on("click",function(a){highlight.clearLayers()});var markerClusters=new L.MarkerClusterGroup({spiderfyOnMaxZoom:true,showCoverageOnHover:false,zoomToBoundsOnClick:true,disableClusteringAtZoom:16});map.addLayer(markerClusters);map.addLayer(highlight);$(window).resize(function(){sizeLayerControl()});function sizeLayerControl(){$(".leaflet-control-layers").css("max-height",$("#map").height()-50)}if(document.body.clientWidth<=767){var isCollapsed=true}else{var isCollapsed=false}var flmarinaLayer=L.geoJson(null);var fl_marina=L.geoJson(null,{pointToLayer:function(a,b){return L.marker(b,{icon:L.icon({iconUrl:"images/marina/fl_marina.png",iconSize:[22,22],iconAnchor:[12,24],popupAnchor:[0,-25]}),title:a.properties.name,riseOnHover:true})},onEachFeature:function(b,a){if(b.properties){var d=b.properties;var c;if(d.photo!==null&&d.photo!=="undefined"){c="<b>"+d.street+"<br />"+d.city+" "+d.state+" "+d.zip+"</b><br  /> Phone: <b>"+d.phone+"</b><br /><a href='"+d.url+"' target='_blank'>More information</a><br /><br /><img src='"+d.photo+"' style='width:100%;' />"}else{c="<b>"+d.street+"<br />"+d.city+" "+d.state+" "+d.zip+"</b><br /> Phone: <b>"+d.phone+"</b><br /><a href='"+d.url+"' target='_blank'>More information</a>"}a.on({click:function(f){$("#feature-title").html(d.name);$("#feature-info").html(c);$("#featureModal").modal("show");highlight.clearLayers().addLayer(L.circleMarker([b.geometry.coordinates[1],b.geometry.coordinates[0]],highlightStyle))}});$("#feature-list tbody").append('<tr class="feature-row" id="'+L.stamp(a)+'" lat="'+a.getLatLng().lat+'" lng="'+a.getLatLng().lng+'"><td style="vertical-align: middle;"><img width="20" height="20" src="images/marina/fl_marina.png"></td><td class="feature-name">'+a.feature.properties.name+'</td><td style="vertical-align: middle;"><i class="fa fa-chevron-right pull-right"></i></td></tr>');flSearch.push({name:a.feature.properties.name,phone:a.feature.properties.phone,source:"fl_marina",id:L.stamp(a),lat:a.feature.geometry.coordinates[1],lng:a.feature.geometry.coordinates[0]})}}});var almarinaLayer=L.geoJson(null);var al_marina=L.geoJson(null,{pointToLayer:function(a,b){return L.marker(b,{icon:L.icon({iconUrl:"images/marina/al_marina.png",iconSize:[22,22],iconAnchor:[12,24],popupAnchor:[0,-25]}),title:a.properties.name,riseOnHover:true})},onEachFeature:function(b,a){if(b.properties){var d=b.properties;var c;if(d.photo!==null&&d.photo!=="undefined"){c="<b>"+d.street+"<br />"+d.city+" "+d.state+" "+d.zip+"</b><br  /> Phone: <b>"+d.phone+"</b><br /><a href='"+d.url+"' target='_blank'>More information</a><br /><br /><img src='"+d.photo+"' style='width:100%;' />"}else{c="<b>"+d.street+"<br />"+d.city+" "+d.state+" "+d.zip+"</b><br /> Phone: <b>"+d.phone+"</b><br /><a href='"+d.url+"' target='_blank'>More information</a>"}a.on({click:function(f){$("#feature-title").html(d.name);$("#feature-info").html(c);$("#featureModal").modal("show");highlight.clearLayers().addLayer(L.circleMarker([b.geometry.coordinates[1],b.geometry.coordinates[0]],highlightStyle))}});$("#feature-list tbody").append('<tr class="feature-row" id="'+L.stamp(a)+'" lat="'+a.getLatLng().lat+'" lng="'+a.getLatLng().lng+'"><td style="vertical-align: middle;"><img width="20" height="20" src="images/marina/al_marina.png"></td><td class="feature-name">'+a.feature.properties.name+'</td><td style="vertical-align: middle;"><i class="fa fa-chevron-right pull-right"></i></td></tr>');alSearch.push({name:a.feature.properties.name,phone:a.feature.properties.phone,source:"al_marina",id:L.stamp(a),lat:a.feature.geometry.coordinates[1],lng:a.feature.geometry.coordinates[0]})}}});var msmarinaLayer=L.geoJson(null);var ms_marina=L.geoJson(null,{pointToLayer:function(a,b){return L.marker(b,{icon:L.icon({iconUrl:"images/marina/ms_marina.png",iconSize:[22,22],iconAnchor:[12,24],popupAnchor:[0,-25]}),title:a.properties.name,riseOnHover:true})},onEachFeature:function(b,a){if(b.properties){var d=b.properties;var c;if(d.photo!==null&&d.photo!=="undefined"){c="<b>"+d.street+"<br />"+d.city+" "+d.state+" "+d.zip+"</b><br  /> Phone: <b>"+d.phone+"</b><br /><a href='"+d.url+"' target='_blank'>More information</a><br /><br /><img src='"+d.photo+"' style='width:100%;' />"}else{c="<b>"+d.street+"<br />"+d.city+" "+d.state+" "+d.zip+"</b><br /> Phone: <b>"+d.phone+"</b><br /><a href='"+d.url+"' target='_blank'>More information</a>"}a.on({click:function(f){$("#feature-title").html(d.name);$("#feature-info").html(c);$("#featureModal").modal("show");highlight.clearLayers().addLayer(L.circleMarker([b.geometry.coordinates[1],b.geometry.coordinates[0]],highlightStyle))}});$("#feature-list tbody").append('<tr class="feature-row" id="'+L.stamp(a)+'" lat="'+a.getLatLng().lat+'" lng="'+a.getLatLng().lng+'"><td style="vertical-align: middle;"><img width="20" height="20" src="images/marina/ms_marina.png"></td><td class="feature-name">'+a.feature.properties.name+'</td><td style="vertical-align: middle;"><i class="fa fa-chevron-right pull-right"></i></td></tr>');msSearch.push({name:a.feature.properties.name,phone:a.feature.properties.phone,source:"ms_marina",id:L.stamp(a),lat:a.feature.geometry.coordinates[1],lng:a.feature.geometry.coordinates[0]})}}});var lamarinaLayer=L.geoJson(null);var la_marina=L.geoJson(null,{pointToLayer:function(a,b){return L.marker(b,{icon:L.icon({iconUrl:"images/marina/la_marina.png",iconSize:[22,22],iconAnchor:[12,24],popupAnchor:[0,-25]}),title:a.properties.name,riseOnHover:true})},onEachFeature:function(b,a){if(b.properties){var d=b.properties;var c;if(d.photo!==null&&d.photo!=="undefined"){c="<b>"+d.street+"<br />"+d.city+" "+d.state+" "+d.zip+"</b><br  /> Phone: <b>"+d.phone+"</b><br /><a href='"+d.url+"' target='_blank'>More information</a><br /><br /><img src='"+d.photo+"' style='width:100%;' />"}else{c="<b>"+d.street+"<br />"+d.city+" "+d.state+" "+d.zip+"</b><br /> Phone: <b>"+d.phone+"</b><br /><a href='"+d.url+"' target='_blank'>More information</a>"}a.on({click:function(f){$("#feature-title").html(d.name);$("#feature-info").html(c);$("#featureModal").modal("show");highlight.clearLayers().addLayer(L.circleMarker([b.geometry.coordinates[1],b.geometry.coordinates[0]],highlightStyle))}});$("#feature-list tbody").append('<tr class="feature-row" id="'+L.stamp(a)+'" lat="'+a.getLatLng().lat+'" lng="'+a.getLatLng().lng+'"><td style="vertical-align: middle;"><img width="20" height="20" src="images/marina/la_marina.png"></td><td class="feature-name">'+a.feature.properties.name+'</td><td style="vertical-align: middle;"><i class="fa fa-chevron-right pull-right"></i></td></tr>');laSearch.push({name:a.feature.properties.name,phone:a.feature.properties.phone,source:"la_marina",id:L.stamp(a),lat:a.feature.geometry.coordinates[1],lng:a.feature.geometry.coordinates[0]})}}});var txmarinaLayer=L.geoJson(null);var tx_marina=L.geoJson(null,{pointToLayer:function(a,b){return L.marker(b,{icon:L.icon({iconUrl:"images/marina/tx_marina.png",iconSize:[22,22],iconAnchor:[12,24],popupAnchor:[0,-25]}),title:a.properties.name,riseOnHover:true})},onEachFeature:function(b,a){if(b.properties){var d=b.properties;var c;if(d.photo!==null&&d.photo!=="undefined"){c="<b>"+d.street+"<br />"+d.city+" "+d.state+" "+d.zip+"</b><br  /> Phone: <b>"+d.phone+"</b><br /><a href='"+d.url+"' target='_blank'>More information</a><br /><br /><img src='"+d.photo+"' style='width:100%;' />"}else{c="<b>"+d.street+"<br />"+d.city+" "+d.state+" "+d.zip+"</b><br /> Phone: <b>"+d.phone+"</b><br /><a href='"+d.url+"' target='_blank'>More information</a>"}a.on({click:function(f){$("#feature-title").html(d.name);$("#feature-info").html(c);$("#featureModal").modal("show");highlight.clearLayers().addLayer(L.circleMarker([b.geometry.coordinates[1],b.geometry.coordinates[0]],highlightStyle))}});$("#feature-list tbody").append('<tr class="feature-row" id="'+L.stamp(a)+'" lat="'+a.getLatLng().lat+'" lng="'+a.getLatLng().lng+'"><td style="vertical-align: middle;"><img width="20" height="20" src="images/marina/tx_marina.png"></td><td class="feature-name">'+a.feature.properties.name+'</td><td style="vertical-align: middle;"><i class="fa fa-chevron-right pull-right"></i></td></tr>');txSearch.push({name:a.feature.properties.name,phone:a.feature.properties.phone,source:"tx_marina",id:L.stamp(a),lat:a.feature.geometry.coordinates[1],lng:a.feature.geometry.coordinates[0]})}}});queue().defer(d3.json,"data/FL_Clean_Marina.geojson").defer(d3.json,"data/AL_Clean_Marina.geojson").defer(d3.json,"data/MS_Clean_Marina.geojson").defer(d3.json,"data/LA_Clean_Marina.geojson").defer(d3.json,"data/TX_Clean_Marina.geojson").await(function(f,g,b,c,e,k){console.log("loading search list");$("#loading").hide();fl_marina.addData(g);al_marina.addData(b);ms_marina.addData(c);la_marina.addData(e);tx_marina.addData(k);map.addLayer(flmarinaLayer);map.addLayer(almarinaLayer);map.addLayer(msmarinaLayer);map.addLayer(lamarinaLayer);map.addLayer(txmarinaLayer);sizeLayerControl();featureList=new List("features",{valueNames:["feature-name"]});featureList.sort("feature-name",{order:"asc"});var i=new Bloodhound({name:"FL",datumTokenizer:function(l){return Bloodhound.tokenizers.whitespace(l.name)},queryTokenizer:Bloodhound.tokenizers.whitespace,local:flSearch,limit:10});var a=new Bloodhound({name:"AL",datumTokenizer:function(l){return Bloodhound.tokenizers.whitespace(l.name)},queryTokenizer:Bloodhound.tokenizers.whitespace,local:alSearch,limit:10});var d=new Bloodhound({name:"MS",datumTokenizer:function(l){return Bloodhound.tokenizers.whitespace(l.name)},queryTokenizer:Bloodhound.tokenizers.whitespace,local:msSearch,limit:10});var j=new Bloodhound({name:"LA",datumTokenizer:function(l){return Bloodhound.tokenizers.whitespace(l.name)},queryTokenizer:Bloodhound.tokenizers.whitespace,local:laSearch,limit:10});var h=new Bloodhound({name:"TX",datumTokenizer:function(l){return Bloodhound.tokenizers.whitespace(l.name)},queryTokenizer:Bloodhound.tokenizers.whitespace,local:txSearch,limit:10});i.initialize();a.initialize();d.initialize();j.initialize();h.initialize();$("#searchbox").typeahead({minLength:4,highlight:true,hint:false},{name:"FL",displayKey:"name",source:i.ttAdapter(),templates:{header:"<h4 class='typeahead-header'><img src='images/marina/fl_marina.png' width='22' height='22'>&nbsp;FL</h4>",suggestion:Handlebars.compile(["{{name}}<br>&nbsp;<small>{{phone}}</small>"].join(""))}},{name:"AL",displayKey:"name",source:a.ttAdapter(),templates:{header:"<h4 class='typeahead-header'><img src='images/marina/al_marina.png' width='22' height='22'>&nbsp;AL</h4>",suggestion:Handlebars.compile(["{{name}}<br>&nbsp;<small>{{phone}}</small>"].join(""))}},{name:"MS",displayKey:"name",source:d.ttAdapter(),templates:{header:"<h4 class='typeahead-header'><img src='images/marina/ms_marina.png' width='22' height='22'>&nbsp;MS</h4>",suggestion:Handlebars.compile(["{{name}}<br>&nbsp;<small>{{phone}}</small>"].join(""))}},{name:"LA",displayKey:"name",source:j.ttAdapter(),templates:{header:"<h4 class='typeahead-header'><img src='images/marina/la_marina.png' width='22' height='22'>&nbsp;LA</h4>",suggestion:Handlebars.compile(["{{name}}<br>&nbsp;<small>{{phone}}</small>"].join(""))}},{name:"TX",displayKey:"name",source:h.ttAdapter(),templates:{header:"<h4 class='typeahead-header'><img src='images/marina/tx_marina.png' width='22' height='22'>&nbsp;TX</h4>",suggestion:Handlebars.compile(["{{name}}<br>&nbsp;<small>{{phone}}</small>"].join(""))}}).on("typeahead:selected",function(m,l){if(l.source==="fl_marina"){if(!map.hasLayer(flmarinaLayer)){map.addLayer(flmarinaLayer)}map.setView([l.lat,l.lng],16);if(map._layers[l.id]){map._layers[l.id].fire("click")}}if(l.source==="al_marina"){if(!map.hasLayer(almarinaLayer)){map.addLayer(almarinaLayer)}map.setView([l.lat,l.lng],16);if(map._layers[l.id]){map._layers[l.id].fire("click")}}if(l.source==="ms_marina"){if(!map.hasLayer(msmarinaLayer)){map.addLayer(msmarinaLayer)}map.setView([l.lat,l.lng],16);if(map._layers[l.id]){map._layers[l.id].fire("click")}}if(l.source==="la_marina"){if(!map.hasLayer(lamarinaLayer)){map.addLayer(lamarinaLayer)}map.setView([l.lat,l.lng],16);if(map._layers[l.id]){map._layers[l.id].fire("click")}}if(l.source==="tx_marina"){if(!map.hasLayer(txmarinaLayer)){map.addLayer(txmarinaLayer)}map.setView([l.lat,l.lng],16);if(map._layers[l.id]){map._layers[l.id].fire("click")}}})});var nauticalChart=L.esri.dynamicMapLayer("http://seamlessrnc.nauticalcharts.noaa.gov/arcgis/rest/services/RNC/NOAA_RNC/MapServer",{opacity:0.5});var groupedOverlay={"Additional layers":{"Nautical Chart":nauticalChart},"Clean Marinas":{"<img src='images/marina/fl_marina.png' width='22' height='22'>&nbsp;FL":flmarinaLayer,"<img src='images/marina/al_marina.png' width='22' height='22'>&nbsp;AL":almarinaLayer,"<img src='images/marina/ms_marina.png' width='22' height='22'>&nbsp;MS":msmarinaLayer,"<img src='images/marina/la_marina.png' width='22' height='22'>&nbsp;LA":lamarinaLayer,"<img src='images/marina/tx_marina.png' width='22' height='22'>&nbsp;TX":txmarinaLayer}};var layerControl=L.control.groupedLayers(baseLayers,groupedOverlay,{}).addTo(map);function syncSidebar(){$("#feature-list tbody").empty();fl_marina.eachLayer(function(a){if(map.hasLayer(flmarinaLayer)){if(map.getBounds().contains(a.getLatLng())){$("#feature-list tbody").append('<tr class="feature-row" id="'+L.stamp(a)+'" lat="'+a.getLatLng().lat+'" lng="'+a.getLatLng().lng+'"><td style="vertical-align: middle;"><img width="18" height="18" src="images/marina/fl_marina.png"></td><td class="feature-name">'+a.feature.properties.name+'</td><td style="vertical-align: middle;"><i class="fa fa-chevron-right pull-right"></i></td></tr>')}}});al_marina.eachLayer(function(a){if(map.hasLayer(almarinaLayer)){if(map.getBounds().contains(a.getLatLng())){$("#feature-list tbody").append('<tr class="feature-row" id="'+L.stamp(a)+'" lat="'+a.getLatLng().lat+'" lng="'+a.getLatLng().lng+'"><td style="vertical-align: middle;"><img width="18" height="18" src="images/marina/al_marina.png"></td><td class="feature-name">'+a.feature.properties.name+'</td><td style="vertical-align: middle;"><i class="fa fa-chevron-right pull-right"></i></td></tr>')}}});ms_marina.eachLayer(function(a){if(map.hasLayer(msmarinaLayer)){if(map.getBounds().contains(a.getLatLng())){$("#feature-list tbody").append('<tr class="feature-row" id="'+L.stamp(a)+'" lat="'+a.getLatLng().lat+'" lng="'+a.getLatLng().lng+'"><td style="vertical-align: middle;"><img width="18" height="18" src="images/marina/ms_marina.png"></td><td class="feature-name">'+a.feature.properties.name+'</td><td style="vertical-align: middle;"><i class="fa fa-chevron-right pull-right"></i></td></tr>')}}});la_marina.eachLayer(function(a){if(map.hasLayer(lamarinaLayer)){if(map.getBounds().contains(a.getLatLng())){$("#feature-list tbody").append('<tr class="feature-row" id="'+L.stamp(a)+'" lat="'+a.getLatLng().lat+'" lng="'+a.getLatLng().lng+'"><td style="vertical-align: middle;"><img width="18" height="18" src="images/marina/la_marina.png"></td><td class="feature-name">'+a.feature.properties.name+'</td><td style="vertical-align: middle;"><i class="fa fa-chevron-right pull-right"></i></td></tr>')}}});tx_marina.eachLayer(function(a){if(map.hasLayer(txmarinaLayer)){if(map.getBounds().contains(a.getLatLng())){$("#feature-list tbody").append('<tr class="feature-row" id="'+L.stamp(a)+'" lat="'+a.getLatLng().lat+'" lng="'+a.getLatLng().lng+'"><td style="vertical-align: middle;"><img width="18" height="18" src="images/marina/tx_marina.png"></td><td class="feature-name">'+a.feature.properties.name+'</td><td style="vertical-align: middle;"><i class="fa fa-chevron-right pull-right"></i></td></tr>')}}});featureList=new List("features",{valueNames:["feature-name"]});featureList.sort("feature-name",{order:"asc"})}map.on("overlayadd",function(a){if(a.layer===flmarinaLayer){markerClusters.addLayer(fl_marina);syncSidebar()}if(a.layer===almarinaLayer){markerClusters.addLayer(al_marina);syncSidebar()}if(a.layer===msmarinaLayer){markerClusters.addLayer(ms_marina);syncSidebar()}if(a.layer===lamarinaLayer){markerClusters.addLayer(la_marina);syncSidebar()}if(a.layer===txmarinaLayer){markerClusters.addLayer(tx_marina);syncSidebar()}});map.on("overlayremove",function(a){if(a.layer===flmarinaLayer){markerClusters.removeLayer(fl_marina);syncSidebar()}if(a.layer===almarinaLayer){markerClusters.removeLayer(al_marina);syncSidebar()}if(a.layer===msmarinaLayer){markerClusters.removeLayer(ms_marina);syncSidebar()}if(a.layer===lamarinaLayer){markerClusters.removeLayer(la_marina);syncSidebar()}if(a.layer===txmarinaLayer){markerClusters.removeLayer(tx_marina);syncSidebar()}});map.on("moveend",function(a){syncSidebar()});$("#print-btn").click(function(){$("#map").print({stylesheet:"../css/bootmap.css"});$(".navbar-collapse.in").collapse("hide");return false});$("#tools-btn").click(function(){$(".leaflet-top.leaflet-left").toggle();return false});$("#draw-btn").click(function(){$(".leaflet-draw").toggle();return false});$("#distance-btn").click(function(){$(".leaflet-control-draw-measure").toggle();return false});$("#upload-btn").click(function(){$(".leaflet-control-filelayer").toggle();return false});var mousemove=document.getElementById("mousemove");map.on("mousemove",function(a){window[a.type].innerHTML=a.latlng.toString()+" Zoom:"+map.getZoom()});var container=$(".leaflet-control-layers")[0];if(!L.Browser.touch){L.DomEvent.disableClickPropagation(container).disableScrollPropagation(container)}else{L.DomEvent.disableClickPropagation(container)}$("#nav-btn").click(function(){$(".navbar-collapse").collapse("toggle");return false});$("#sidebar-toggle-btn").click(function(){$("#sidebar").toggle();map.invalidateSize();return false});$("#sidebar-hide-btn").click(function(){$("#sidebar").hide();map.invalidateSize()});$("#panel-btn").click(function(){$("#sidebar").toggle();map.invalidateSize();return false});function sidebarClick(b){var a=markerClusters.getLayer(b);map.setView([a.getLatLng().lat,a.getLatLng().lng],13);a.fire("click");if(document.body.clientWidth<=767){$("#sidebar").hide();map.invalidateSize()}}$("#searchbox").click(function(){$(this).select()});$("#searchbox").keypress(function(a){if(a.which==13){a.preventDefault()}});$(document).on("click",".feature-row",function(a){$(document).off("mouseout",".feature-row",clearHighlight);sidebarClick(parseInt($(this).attr("id"),10))});$(document).on("mouseover",".feature-row",function(a){highlight.clearLayers().addLayer(L.circleMarker([$(this).attr("lat"),$(this).attr("lng")],highlightStyle))});$(document).on("mouseout",".feature-row",clearHighlight);$("#about-btn").click(function(){$("#aboutModal").modal("show");$(".navbar-collapse.in").collapse("hide");return false});$("#featureModal").on("hidden.bs.modal",function(a){$(document).on("mouseout",".feature-row",clearHighlight)});